function Output = three_bots_centroid_inv_jacobian_matrix_exact(u)
%This function computes the robot velocities based on the cluster
%velocities.
%arguments:     u = [theta_c p q beta]
%output:     output = [J_inv]

%Initialize variables
theta=u(1);
p=u(2); 
q=u(3); 
beta=u(4);

  
J_inv = [[  1,  0,    1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),  0,   0,   0,  1/3*sin(theta)*(q*cos(beta)+p)/(p^2+q^2+2*p*q*cos(beta))^(1/2),	1/3*sin(theta)*(q+p*cos(beta))/(p^2+q^2+2*p*q*cos(beta))^(1/2),     -1/3/(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)*p*q*sin(beta)]
        [	0,	1,	-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta),  0,   0,   0,	1/3*cos(theta)*(q*cos(beta)+p)/(p^2+q^2+2*p*q*cos(beta))^(1/2),     1/3*cos(theta)*(q+p*cos(beta))/(p^2+q^2+2*p*q*cos(beta))^(1/2),     -1/3/(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta)*p*q*sin(beta)]
        [	0,	0,	-1, 1,   0,   0,	0,	0,	0]
        [	1,	0,	1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta)-p*sin(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta))), 0,   0,   0,	1/3*(sin(theta)*p^3+3*sin(theta)*p^2*q*cos(beta)+2*sin(theta)*p*q^2*cos(beta)^2+sin(theta)*p*q^2+sin(theta)*q^3*cos(beta)+3*cos(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p^2+6*cos(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p*q*cos(beta)+3*cos(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*q^2+3*p*sin(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*q*sin(beta)*(p^2+q^2+2*p*q*cos(beta))^(1/2))/(p^2+q^2+2*p*q*cos(beta))^(3/2),	1/3*(3*sin(theta)*p*q^2*cos(beta)+sin(theta)*q*p^2+sin(theta)*q^3+2*sin(theta)*p^2*cos(beta)^2*q+sin(theta)*p^3*cos(beta)-3*p^2*sin(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*sin(beta)*(p^2+q^2+2*p*q*cos(beta))^(1/2))/(p^2+q^2+2*p*q*cos(beta))^(3/2),	-1/3*p*q*(2*sin(theta)*sin(beta)*p*q*cos(beta)+sin(theta)*sin(beta)*p^2+sin(theta)*sin(beta)*q^2+3*sin(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p*cos(beta)+3*sin(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*q)/(p^2+q^2+2*p*q*cos(beta))^(3/2)]
        [	0,	1,	-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)-p*cos(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta))),	 0,   0,   0,  1/3*(cos(theta)*p^3+3*cos(theta)*p^2*q*cos(beta)+2*cos(theta)*p*q^2*cos(beta)^2+cos(theta)*p*q^2+cos(theta)*q^3*cos(beta)-3*sin(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p^2-6*sin(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p*q*cos(beta)-3*sin(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*q^2+3*p*cos(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*q*sin(beta)*(p^2+q^2+2*p*q*cos(beta))^(1/2))/(p^2+q^2+2*p*q*cos(beta))^(3/2),	1/3*(3*cos(theta)*p*q^2*cos(beta)+cos(theta)*q*p^2+cos(theta)*q^3+2*cos(theta)*p^2*cos(beta)^2*q+cos(theta)*p^3*cos(beta)-3*p^2*cos(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*sin(beta)*(p^2+q^2+2*p*q*cos(beta))^(1/2))/(p^2+q^2+2*p*q*cos(beta))^(3/2),	-1/3*p*q*(2*cos(theta)*sin(beta)*p*q*cos(beta)+cos(theta)*sin(beta)*p^2+cos(theta)*sin(beta)*q^2+3*cos(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p*cos(beta)+3*cos(atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*q)/(p^2+q^2+2*p*q*cos(beta))^(3/2)]
        [	0,	0,	-1,	 0,   1,   0,  0,	0,	0]
        [	1,	0,	1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta)-q*sin(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta))),  0,   0,   0,	1/3*(sin(theta)*p^3+3*sin(theta)*p^2*q*cos(beta)+2*sin(theta)*p*q^2*cos(beta)^2+sin(theta)*p*q^2+sin(theta)*q^3*cos(beta)+3*q^2*sin(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*sin(beta)*(p^2+q^2+2*p*q*cos(beta))^(1/2))/(p^2+q^2+2*p*q*cos(beta))^(3/2),   1/3*(3*sin(theta)*p*q^2*cos(beta)+sin(theta)*q*p^2+sin(theta)*q^3+2*sin(theta)*p^2*cos(beta)^2*q+sin(theta)*p^3*cos(beta)+6*cos(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p*q*cos(beta)+3*cos(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p^2+3*cos(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*q^2-3*q*sin(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*sin(beta)*p*(p^2+q^2+2*p*q*cos(beta))^(1/2))/(p^2+q^2+2*p*q*cos(beta))^(3/2),	-1/3*p*q*(2*sin(theta)*sin(beta)*p*q*cos(beta)+sin(theta)*sin(beta)*p^2+sin(theta)*sin(beta)*q^2-3*sin(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*q*cos(beta)-3*sin(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p)/(p^2+q^2+2*p*q*cos(beta))^(3/2)]
        [	0,	1,	-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)-q*cos(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta))),  0,   0,   0,	1/3*(cos(theta)*p^3+3*cos(theta)*p^2*q*cos(beta)+2*cos(theta)*p*q^2*cos(beta)^2+cos(theta)*p*q^2+cos(theta)*q^3*cos(beta)+3*q^2*cos(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*sin(beta)*(p^2+q^2+2*p*q*cos(beta))^(1/2))/(p^2+q^2+2*p*q*cos(beta))^(3/2), -1/3*(-3*cos(theta)*p*q^2*cos(beta)-cos(theta)*q*p^2-cos(theta)*q^3-2*cos(theta)*p^2*cos(beta)^2*q-cos(theta)*p^3*cos(beta)+6*sin(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p*q*cos(beta)+3*sin(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p^2+3*sin(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*q^2+3*q*cos(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*sin(beta)*p*(p^2+q^2+2*p*q*cos(beta))^(1/2))/(p^2+q^2+2*p*q*cos(beta))^(3/2),	1/3*p*q*(-2*cos(theta)*sin(beta)*p*q*cos(beta)-cos(theta)*sin(beta)*p^2-cos(theta)*sin(beta)*q^2+3*cos(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*q*cos(beta)+3*cos(-beta+atan2(q*sin(beta),q*cos(beta)+p)-atan2(-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*cos(theta),-1/3*(p^2+q^2+2*p*q*cos(beta))^(1/2)*sin(theta)))*(p^2+q^2+2*p*q*cos(beta))^(1/2)*p)/(p^2+q^2+2*p*q*cos(beta))^(3/2)]
        [	0,	0,	-1,	0,   0,   1, 0,	0,	0]];

Output = J_inv;
